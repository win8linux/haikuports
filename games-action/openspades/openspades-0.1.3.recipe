SUMMARY="A game client compatible with Ace of Spades 0.75"
DESCRIPTION="OpenSpades is a clone of Ace of Spades 0.75, which is a free \
online first-person shooter created by Ben Aksoy, featuring fully destructible \
terrain and plenty of game modes (including the well-known Capture the Flag) \
created by the community."
HOMEPAGE="https://openspades.yvt.jp/"
COPYRIGHT="2013-2019 OpenSpades Community"
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="https://github.com/yvt/openspades/archive/v$portVersion.tar.gz"
CHECKSUM_SHA256="ecd7aaf568f80712d981ecdd7bf9e380221dc2c16e86d2e56a0ddda87432bea3"
SOURCE_FILENAME="openspades-v$portVersion.tar.gz"
SOURCE_DIR="openspades-$portVersion"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	openspades$secondaryArchSuffix = $portVersion
	app:OpenSpades$secondaryArchSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	xdg_utils$secondaryArchSuffix
	lib:libalut$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libcrypto$secondaryArchSuffix
	lib:libfreetype$secondaryArchSuffix
	lib:libGL$secondaryArchSuffix
	lib:libglew$secondaryArchSuffix
	lib:libjpeg$secondaryArchSuffix
	lib:libMagick++_6.Q16$secondaryArchSuffix
	lib:libogg$secondaryArchSuffix
	lib:libopus$secondaryArchSuffix
	lib:libopusfile$secondaryArchSuffix
	lib:libSDL2_2.0$secondaryArchSuffix
	lib:libSDL2_image_2.0$secondaryArchSuffix
	lib:libxcb$secondaryArchSuffix
	"
BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libalut$secondaryArchSuffix
	devel:libcurl$secondaryArchSuffix
	devel:libcrypto$secondaryArchSuffix
	devel:libfreetype$secondaryArchSuffix
	devel:libGL$secondaryArchSuffix
	devel:libglew$secondaryArchSuffix
	devel:libjpeg$secondaryArchSuffix
	devel:libMagick++_6.Q16$secondaryArchSuffix
	devel:libogg$secondaryArchSuffix
	devel:libopus$secondaryArchSuffix
	devel:libopusfile$secondaryArchSuffix
	devel:libSDL2_2.0$secondaryArchSuffix
	devel:libSDL2_image_2.0$secondaryArchSuffix
	devel:libxcb$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:file
	cmd:find
	cmd:gcc$secondaryArchSuffix
	cmd:cmake
	cmd:make
	cmd:pkg_config
	cmd:wget
	cmd:zip
	"

BUILD()
{
	mkdir -p openspades.mk && cd openspades.mk
	cmake .. \
		-DCMAKE_BUILD_TYPE=RelWithDebInfo \
		-DOPENSPADES_INSTALL_BINARY=$appsDir/OpenSpades \
		-DOPENSPADES_INSTALL_RESOURCES=$appsDir/OpenSpades/Resources \
		-DOPENSPADES_INSTALL_DOC=`finddir B_USER_DOCUMENTATION_DIRECTORY`/OpenSpades \
		-DOPENSPADES_INSTALL_MAN=`finddir B_SYSTEM_DOCUMENTATION_DIRECTORY`/man/man6

	make $jobArgs
}

INSTALL()
{
	make install

	addAppDeskbarSymlink "$appsDir/OpenSpades/openspades" "OpenSpades"
}
