SUMMARY="Sci-Fi sandbox voxel game with industry and automation"
DESCRIPTION="Blackvoxel is a new sandbox game based on a voxel engine.

The story takes place in the future. Tired of the civilisation, you decided \
to retire to a distant world. You bought a new discovered planet in your \
local planet selling agency.

The dealer made a good price on a paradisiac planet with beautiful \
landscapes with islands, sandy beaches, palm forest and a beautiful blue sky. \
The catalog showed a friendly world populated of peaceful animals.

You take your new ship and go through the long journey. During the trip, you \
dreamed of your new world. And finaly, after a year of boring travel you \
reached the orbit and started the landing procedure.

Unfortunately, you hit an asteroid that was not on the map and your ship was \
heavily damaged. The ship wasn't controllable anymore and finally you crashed \
on your planet.

By chance, you still alive, but most of your equipment and materials was \
destroyed.

As soon as you looked around you, your realized that the planet wasn't what \
the dealer promised to you.

What a strange and desolated world with a black sky and strange luminous \
blocks!

All what you see is uncommon and you know nothing about it...

As you look on your personal digital assistant, you noticed you received an \
important email that arrived using powerful long distance intergalactic \
emitters: the agency said that they may have made a mistake because someone \
confused planet data files. They said that in the eventuality you remain \
alive, the sales contract did not mention the details of the surface of the \
planet, and infortunately, they can't made any exchange and refund.

But before you can do something, you have no choice: you have no \
intergalactic ship to escape and no suitable communication equipment to \
query some help.

What you will do now is up to you...
"
HOMEPAGE="https://www.blackvoxel.com/"
COPYRIGHT="2010-2021 Laurent Thiebaut, Olivia Merle"
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="https://github.com/Blackvoxel/Blackvoxel/archive/$portVersion.tar.gz"
CHECKSUM_SHA256="46c93933486f700de4fbc9e24b026c768954998db8acc95d4590dc57b16b1470"
SOURCE_DIR="Blackvoxel-$portVersion"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	blackvoxel$secondaryArchSuffix = $portVersion
	app:blackvoxel = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	cmd:sq$secondaryArchSuffix
	lib:libglew$secondaryArchSuffix
	lib:libSDL_1.2$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libglew$secondaryArchSuffix
	devel:libSDL_1.2$secondaryArchSuffix
	devel:libsqstdlib$secondaryArchSuffix
	devel:libsquirrel$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:getconf
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	"

PATCHES="
	blackvoxel-2.5.patchset
	"

BUILD()
{
	if [ $effectiveTargetArchitecture = x86 ]; then
		export CPU_BITS=32
	else
		export CPU_BITS=64
	fi

	make BV_DATA_LOCATION_DIR='finddir B_SYSTEM_DATA_DIRECTORY'/blackvoxel $jobArgs
}

INSTALL()
{
	make install doinstall=true BV_DATA_LOCATION_DIR='finddir B_SYSTEM_DATA_DIRECTORY'/blackvoxel BV_BINARY_INSTALL_DIR=$appsDir/Blackvovel
	addAppDeskbarSymlink $appsDir/Blackvoxel/blackvoxel "Blackvoxel"
}
